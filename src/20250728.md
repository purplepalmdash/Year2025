# 20250728
### 1. debian(arm64) kolla
Debian arm, system info:      

```
root@debiankolla:~# free -m
               total        used        free      shared  buff/cache   available
Mem:           19972         339       19731           4         108       19633
Swap:            976           0         976
root@debiankolla:~# cat /etc/issue
Debian GNU/Linux 12 \n \l
root@debiankolla:~# uname -a
Linux debiankolla 6.1.0-35-arm64 #1 SMP Debian 6.1.137-1 (2025-05-07) aarch64 GNU/Linux
```
Install required packages:        

```
apt install -y vim nethogs sudo iotop
sudo apt install git python3-dev libffi-dev python3-venv gcc libssl-dev git python3-pip python3-full
```
Virtual env:       

```
python3 -m venv $HOME/kolla-openstack
source $HOME/kolla-openstack/bin/activate
pip install -U pip
pip install 'ansible>=8,<9'
vim $HOME/ansible.cfg
[defaults]
host_key_checking=False
pipelining=True
forks=100
pip install git+https://opendev.org/openstack/kolla-ansible@stable/2024.2
```
Create the kolla deployment files:       

```
# mkdir /etc/kolla
# cp /root/kolla-openstack/share/kolla-ansible/etc_examples/kolla/* /etc/kolla/
# ls /etc/kolla/
globals.yml  passwords.yml
# cp /root/kolla-openstack/share/kolla-ansible/ansible/inventory/all-in-one .
```
Create lvm:      

```
apt install -y lvm2
Create lvms as before.  
```
Gen password:      

```
kolla-genpwd
export LC_ALL="en_US.UTF-8"
export LC_CTYPE="en_US.UTF-8"
sudo dpkg-reconfigure locales
reboot
 kolla-ansible install-deps
```
Deploy:       

```
cd /etc/kolla
kolla-ansible bootstrap-servers -i all-in-one
apt install -y pkg-config libdbus-1-dev libglib2.0-dev
pip install docker
pip install dbus-python
kolla-ansible prechecks -i all-in-one
kolla-ansible deploy -i all-in-one
kolla-ansible post-deploy -i all-in-one
pip install python-zunclient
openstack appcontainer host list
```
Upgrade kernel for supporing redroid:       

```
sudo apt-get install build-essential linux-source bc kmod cpio flex libncurses5-dev libelf-dev libssl-dev dwarves bison
cd /usr/src
tar xJvf linux-source-6.1.tar.xz
cd linux-source-6.1
make menuconfig
### Open some configs
make -j`nproc` bindeb-pkg
ls ../*.deb
../linux-headers-6.1.137hhhddd_6.1.137hhhddd-2_arm64.deb
../linux-image-6.1.137hhhddd_6.1.137hhhddd-2_arm64.deb
../linux-image-6.1.137hhhddd-dbg_6.1.137hhhddd-2_arm64.deb
../linux-libc-dev_6.1.137hhhddd-2_arm64.deb
cd ..
apt install ./linux-headers-6.1.137hhhddd_6.1.137hhhddd-2_arm64.deb ./linux-image-6.1.137hhhddd_6.1.137hhhddd-2_arm64.deb
reboot
```
Examine the result:      

```
# cat /boot/config-6.1.137hhhddd | grep -i binder
CONFIG_ANDROID_BINDER_IPC=y
CONFIG_ANDROID_BINDERFS=y
CONFIG_ANDROID_BINDER_DEVICES="binder,hwbinder,vndbinder"
```
Edit privileged related items:      

```
cd /etc/kolla
vim zun-api/zun.conf 
vim zun-compute/zun.conf 
vim zun-wsproxy/zun.conf 
vim zun-cni-daemon/zun.conf

docker cp policy.json zun_api:/etc/zun/
docker cp policy.json zun_compute:/etc/zun/
docker cp policy.json zun_wsproxy:/etc/zun/
docker cp policy.json zun_cni_daemon:/etc/zun

docker restart zun_compute && docker restart zun_api && docker restart zun_wsproxy && docker restart zun_cni_daemon
```

