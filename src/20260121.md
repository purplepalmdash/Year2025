# 20260121
### 1. 构建知识库

![./images/2026_01_21_15_15_21_897x494.jpg](./images/2026_01_21_15_15_21_897x494.jpg)

### 2. build kbox

```
./install.sh 
./install.sh
curl https://mirrors.bfsu.edu.cn/git/git-repo -o /usr/local/bin/repo
cp /usr/local/bin/repo  /usr/bin
chmod 777 /usr/bin/repo 
chmod 777 /usr/local/bin/repo
apt install sudo
apt install -y git-lfs
mkdir aosp
cd aosp/
git config --global user.email "ddd@hhh.com"
git config --global user.name "ddd"
repo init --depth 1 -u https://mirrors.bfsu.edu.cn/git/AOSP/platform/manifest -b android-11.0.0_r48
repo sync
cd kbox24/
tar xvf mesa-22.1.7.tar.xz 
mv mesa-22.1.7 mesa
cp -r mesa /kunpeng/aosp/external/
tar xvf llvm-13.0.1.src.tar.xz 
mv llvm-13.0.1.src llvm70
cp -r llvm70/ /kunpeng/aosp/external/
unzip libdrm-libdrm-2.4.111-f801b07a60740425604d6563e5dc399375108bc4.zip 
mv libdrm-libdrm-2.4.111-f801b07a60740425604d6563e5dc399375108bc4 libdrm
cp -r libdrm /kunpeng/aosp/external/
tar xvf libva-2.14.0.tar.gz 
mv libva-2.14.0 libva
cp -r libva /kunpeng/aosp/external/
unzip vmi-CloudPhone.zip 
cp -r vmi-CloudPhone/CloudPhoneService/VideoEngine/Media/video_decoder/ /kunpeng/aosp/external/
cp -r vmi-CloudPhone/CloudPhoneService/VideoEngine/Media/vendor /kunpeng/aosp/external/
unzip Kbox-AOSP11.zip 
cd Kbox-AOSP11/patchForExagear/guestOS/aosp11/
cp 0001-exagear-adapt-android-11.0.0_r48.patch /kunpeng/aosp
cd /kunpeng/aosp
patch -p1 < 0001-exagear-adapt-android-11.0.0_r48.patch 
cd /kunpeng/kbox24/
tar xzvf ExaGear_ARM32-ARM64_V2.5.tar.gz 
cd ExaGear_ARM32-ARM64
cp * /kunpeng/kbox24/Kbox-AOSP11/patchForExagear/guestOS/aosp11/vendor/huawei/exagear/prebuilts/
cp -r /kunpeng/kbox24/Kbox-AOSP11/patchForExagear/guestOS/aosp11/vendor/ /kunpeng/aosp/
vim patch.sh
chmod 777 patch.sh 
./patch.sh 
unzip BoostKit-kbox_6.0.0_11.zip 
unzip Kbox-BoostKit-kbox_6.0.0-aosp11.0-binary.zip 
cp -rf product_prebuilt/ /kunpeng/aosp/
rm -rf /kunpeng/aosp/device/generic/goldfish-opengl/system/codecs/
sed -i 's/include $(GOLDFISH_OPENGL_PATH)\/system\/codecs\/omx/#include $(GOLDFISH_OPENGL_PATH)\/system\/codecs\/omx/g' /kunpeng/aosp/device/generic/goldfish-opengl/Android.mk 
mkdir -p /kunpeng/aosp/vendor/kbox
chmod -R 700 /kunpeng/aosp/vendor/kbox/
cp -rf product /kunpeng/aosp/vendor/kbox/
cp -rf products /kunpeng/aosp/vendor/kbox/
ls /kunpeng/aosp/vendor/kbox/
vim /kunpeng/aosp/vendor/kbox/products/kbox.mk 
cd /kunpeng/aosp/
rm -rf ./build/target/product/security/release*
chmod +x ./development/tools/make_key
ls ./development/tools/make_key
./development/tools/make_key build/target/product/security/releasekey '/C=CN/ST=GuangDong/L=Guangzhou/O=tyy/OU=tyy/CN=TYY/emailAddress=tyy@tyy.com'
apt install -y rsync
cat ~/.bashrc 
export PATH=~/buildtools/meson-0.63.2:$PATH
source build/envsetup.sh 
lunch kbox_arm64-userdebug
make -j16
history
####### Logout the docker:   
chmod +x create-package.sh 
./create-package.sh /kunpeng/aosp/out/target/product/arm64/system.img 
```
install.sh is listed as following:      

```
# cat install.sh
apt-get install -y libgl1-mesa-dev g++-multilib git flex bison gperf build-essential
apt-get install -y tofrodos python3-markdown xsltproc dpkg-dev libsdl1.2-dev
apt-get install -y git-core gnupg zip curl zlib1g-dev gcc-multilib
apt-get install -y libc6-dev-i386 libx11-dev libncurses5-dev lib32ncurses5-dev x11proto-core-dev
apt-get install -y libxml2-utils unzip m4 lib32z-dev ccache libssl-dev gettext python3-mako libncurses5
apt-get install -y python3-chardet python3-markupsafe python3-packaging python3-pkg-resources python3-pygments
apt-get install -y python3-pyparsing python3-six python3-yaml python2 python2.7
apt-get install -y python3 python3-apport python3-apt python3-attr python3-automat
apt-get install -y python3-blinker python3-certifi python3-cffi-backend
apt-get install -y python3-click python3-colorama python3-commandnotfound
apt-get install -y python3-configobj python3-constantly
apt-get install -y python3-cryptography python3-dbus python3-debconf
apt-get install -y python3-debian python3-dev python3-distro python3-distro-info
apt-get install -y python3-distupgrade python3-distutils python3-entrypoints
apt-get install -y python3-gdbm python3-gi python3-hamcrest python3-httplib2
apt-get install -y python3-hyperlink python3-idna python3-importlib-metadata
apt-get install -y python3-incremental python3-jinja2 python3-json-pointer
apt-get install -y python3-jsonpatch python3-jsonschema python3-jwt
apt-get install -y python3-keyring python3-launchpadlib python3-lazr.restfulclient
apt-get install -y python3-lazr.uri python3-lib2to3
apt-get install -y python3-more-itertools python3-nacl python3-netifaces python3-newt
apt-get install -y python3-oauthlib python3-openssl python3-pip
apt-get install -y python3-problem-report python3-pyasn1
apt-get install -y python3-pyasn1-modules python3-pymacaroons python3-pyrsistent
apt-get install -y python3-requests python3-requests-unixsocket python3-secretstorage
apt-get install -y python3-serial python3-service-identity
apt-get install -y python3-setuptools python3-simplejson
apt-get install -y python3-software-properties python3-systemd python3-twisted
apt-get install -y python3-update-manager python3-urllib3 python3-wadllib
apt-get install -y python3-wheel python3-zipp python3-zope.interface
apt-get install -y python-is-python3 ninja-build autocon
```
