# 20250926
### 1. libvirt(legacy seabios)
Use ide for startup:     

```
root@idv-TC-9073:/var/lib/libvirt/images# cp win7_test.qcow2 ide_win7_test.qcow2
```
sound:    

![./images/2025_09_26_08_31_25_488x378.jpg](./images/2025_09_26_08_31_25_488x378.jpg)

### 2. sata verification
Change to sata:    

![./images/2025_09_26_08_53_56_705x558.jpg](./images/2025_09_26_08_53_56_705x558.jpg)

OK:     

![./images/2025_09_26_08_56_17_1092x682.jpg](./images/2025_09_26_08_56_17_1092x682.jpg)

### 3. virtio verification
Also OK.   

![./images/2025_09_26_09_00_49_1013x711.jpg](./images/2025_09_26_09_00_49_1013x711.jpg)

Add configuration:     

```
  <features>
    <acpi/>
    <apic/>
+    <hyperv>
+      <relaxed state='on'/>
+      <vapic state='on'/>
+      <spinlocks state='on' retries='8191'/>
+    </hyperv>
    <vmport state='off'/>
  </features>
  <clock offset='localtime'>
    <timer name='rtc' tickpolicy='catchup'/>
    <timer name='pit' tickpolicy='delay'/>
    <timer name='hpet' present='no'/>
+    <timer name='hypervclock' present='yes'/>
  </clock
```
Also OK.   

### 4. Add seabios pic
Add items:    

```
  <qemu:commandline>
    <qemu:arg value='-set'/>
    <qemu:arg value='device.hostdev0.x-igd-gms=1'/>
    <qemu:arg value='-set'/>
    <qemu:arg value='device.hostdev0.x-igd-opregion=on'/>
    <qemu:arg value='-set'/>
    <qemu:arg value='device.hostdev0.x-vga=on'/>
    <qemu:arg value='-boot'/>
    <qemu:arg value='menu=on,strict=on,splash=/usr/share/seabios/tyyidv.jpg'/>
    <qemu:arg value='-bios'/>
    <qemu:arg value='/usr/share/seabios/bios_1.16.bin'/>
  </qemu:commandline>
``` 
Generated jpg:     

```
 convert tianyiidv.jpg -resize 640x480! tyidv.jpg
 convert tyidv.jpg -channel-fx 'red<=>blue' tyyidv.jpg
```

### 6. one-kvm
`https://github.com/mofeng-git/One-KVM`
start via:     

```
sudo docker run --name kvmd -itd --restart=always \
    --device /dev/video0:/dev/video0 \
    --device /dev/ttyUSB0:/dev/ttyUSB0 \
    -p 8080:8080 -p 4430:4430 -p 5950:5900 -p 623:623 \
    silentwind0/kvmd
```
Then visit `http://192.168.1.209:8080` you could get the one-kvm desktop.    

If on ubuntu, you have to remove brltty, or you won't see the ttyUSB0:    

```
$ sudo apt remove brltty
```

### 7. 启动速度对比
业界最强的pve启动速度 vs ubuntu启动速度

```
ubuntu:    
00:02       启动
00:23       seabios logo
00:30       windows启动画面
00:40       windows进入系统
```
pve:    
```
00:08       点击按钮启动
00:18       seabios logo
00:25       windows启动画面
00:36       windows进入登陆界面
```

4G memory startup time:     

```
ubuntu: 
00:16   virsh start
00:31   seabios logo
00:38   windows启动画面
00:48   windows进入系统
```

4G memory startup time(sleep 1 in vfio-startup.sh):     

```
ubuntu: 
00:05   virsh start
00:19   seabios logo
00:26   windows启动画面
00:37   windows进入系统
```
考虑到pve是直接将显卡置为vfio就绪状态，因而这个结论是合理的。    
### 8. i3-8100速度对比
uefi下win7启动:     

```
00:10   tiano core画面出现
00:13   windows启动画面
00:24   windows桌面可用
```

seabios win7启动:     

```
00:17   seabios画面
00:25   windows启动画面
00:35   直接进入windows桌面

